<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="author" content="Alex Zhao"><meta property="og:title" content="xpath 简明教程"><meta property="og:site_name" content="Alex Coding"><meta property="og:type" content="article"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>xpath 简明教程 - Alex Coding</title><link rel="shortcut icon" href="https://hexo.io/icon/favicon-96x96.png"><link rel="stylesheet" href="/css/style.css"></head><body><header class="site-header"><div class="header-inside"><div class="logo"><a href="/" rel="home"><img src="https://hexo.io/logo.svg" alt="Alex Coding" height="60"></a></div><nav class="navbar"><div class="collapse"><ul class="navbar-nav"><li><a href="/.">home</a></li><li><a href="/archives">archive</a></li></ul></div></nav><div class="button-wrap"><button class="menu-toggle">Primary Menu</button></div></div></header><div class="content-area"><div class="post"><div class="container"><article><div class="post-header"><h1 class="entry-title">xpath 简明教程</h1><p class="posted-on">2015-01-23</p><div class="tags-links"><a href="/tags/xpath/" rel="tag">xpath</a></div></div><div class="entry-content"><h2 id="什么是 xpath"><a href="# 什么是 xpath" class="headerlink" title="什么是 xpath?"></a>什么是 xpath?</h2><blockquote><p>XPath 是一门在 XML 文档中查找信息的语言。XPath 可用来在 XML 文档中对元素和属性进行遍历。</p></blockquote><a id="more"></a><h2 id="XPath- 术语"><a href="#XPath- 术语" class="headerlink" title="XPath 术语"></a>XPath 术语</h2><table><thead><tr><th>术语</th><th>描述</th></tr></thead><tbody><tr><td>节点 (node)</td><td>在 XPath 中，有七种类型的节点：元素、属性、文本、命名空间、处理指令、注释以及文档（根）节点。XML 文档是被作为节点树来对待的。树的根被称为文档节点或者根节点。</td></tr><tr><td>基本值（或称原子值，Atomic value）</td><td>无父无子的节点</td></tr><tr><td>项目（Item）</td><td>基本值或节点</td></tr><tr><td>节点关系</td><td>父、子、同胞等</td></tr></tbody></table><h2 id="XPath- 用法"><a href="#XPath- 用法" class="headerlink" title="XPath 用法"></a>XPath 用法</h2><p>选取节点</p><blockquote><p>下面列举了最有用的节点表达式</p></blockquote><table><thead><tr><th>表达式</th><th>描述</th></tr></thead><tbody><tr><td>nodename</td><td>选取此节点的所有子节点。</td></tr><tr><td>/</td><td>从根节点选取。</td></tr><tr><td>//</td><td>从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置。</td></tr><tr><td>.</td><td>选取当前节点。</td></tr><tr><td>..</td><td>选取当前节点的父节点。</td></tr><tr><td>@</td><td>选取属性。</td></tr></tbody></table><p><strong>text() 选取节点内元素 </strong></p><p>下面以一段 xml 代码为例：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">bookstore</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">"eng"</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">"eng"</span>&gt;</span>Learning XML<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>39.95<span class="tag">&lt;/<span class="name">price</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">bookstore</span>&gt;</span></div></pre></td></tr></table></figure><table><thead><tr><th>路径表达式</th><th>结果</th></tr></thead><tbody><tr><td>bookstore</td><td>选取 bookstore 元素的所有子节点。</td></tr><tr><td>/bookstore</td><td>选取根元素 bookstore。注释：假如路径起始于正斜杠 (/)，则此路径始终代表到某元素的绝对路径！</td></tr><tr><td>bookstore/book</td><td>选取属于 bookstore 的子元素的所有 book 元素。</td></tr><tr><td>//book</td><td>选取所有 book 子元素，而不管它们在文档中的位置。</td></tr><tr><td>bookstore//book</td><td>选择属于 bookstore 元素的后代的所有 book 元素，而不管它们位于 bookstore 之下的什么位置。</td></tr><tr><td>//@lang</td><td>选取名为 lang 的所有属性。</td></tr></tbody></table><h2 id="谓语"><a href="# 谓语" class="headerlink" title="谓语"></a>谓语</h2><p>谓语用来查找某个特定的节点或者包含某个指定的值的节点。<br>谓语被嵌在方括号中。</p><table><thead><tr><th>路径表达式</th><th>结果</th></tr></thead><tbody><tr><td>/bookstore/book<a href="http://www.oschina.net/" title="开源中国" target="_blank" rel="external">1</a></td><td>选取属于 bookstore 子元素的第一个 book 元素。</td></tr><tr><td>/bookstore/book[last()]</td><td>选取属于 bookstore 子元素的最后一个 book 元素。</td></tr><tr><td>/bookstore/book[last()-1]</td><td>选取属于 bookstore 子元素的倒数第二个 book 元素。</td></tr><tr><td>/bookstore/book[position()&lt;3]</td><td>选取最前面的两个属于 bookstore 元素的子元素的 book 元素。</td></tr><tr><td>//title[@lang]</td><td>选取所有拥有名为 lang 的属性的 title 元素。</td></tr><tr><td>//title[@lang=’eng’]</td><td>选取所有 title 元素，且这些元素拥有值为 eng 的 lang 属性。</td></tr><tr><td>/bookstore/book[price&gt;35.00]</td><td>选取 bookstore 元素的所有 book 元素，且其中的 price 元素的值须大于 35.00。</td></tr><tr><td>/bookstore/book[price&gt;35.00]/title</td><td>选取 bookstore 元素中的 book 元素的所有 title 元素，且其中的 price 元素的值须大于 35.00。</td></tr></tbody></table><h2 id="实战"><a href="# 实战" class="headerlink" title="实战"></a>实战</h2><p>以 <a href="http://www.oschina.net/" title="开源中国" target="_blank" rel="external">开源中国 </a>为例，我们来试试 XPath 能做什么？</p><ol><li><p>假设我们想要获取图示部分的内容：<br><img src="http://harchiko.qiniudn.com/how-to-use-xpath/oschina.png" alt="开源中国" title="开源中国"></p></li><li><p>打开 Firebug，定位到这一部分：<br><img src="http://harchiko.qiniudn.com/how-to-use-xpath/oschina-firebug.png" alt="Firebug" title="firebug"><br>xpath 写为: <code>id(&#39;ProjectNews&#39;)/ul/li/a</code></p></li><li><p>使用插件 xpath checker 查看到获取到的信息<br><img src="http://harchiko.qiniudn.com/how-to-use-xpath/xpath.png" alt="xpath" title="xpath"></p></li></ol><p>获取到了。</p><h2 id="美女"><a href="# 美女" class="headerlink" title="美女"></a>美女</h2><p>比如： 下载花瓣中这个画板的图片 <a href="http://huaban.com/boards/293742/" target="_blank" rel="external">http://huaban.com/boards/293742/</a></p><p>图片如图：<br><img src="http://harchiko.qiniudn.com/how-to-use-xpath/huaban.png" alt="花瓣美女"></p><p>要下载这里面每一个美女的图片，重复我们之前的步骤：</p><p>为了找到图片的 URL，打开 firebug，找到图片对应的 xpath 路径，经过一番尝试：<code>//div/div/div/div/a/img[1][@width=&quot;236&quot;]</code>可以顺利找到所有的图片。</p><p><img src="http://harchiko.qiniudn.com/how-to-use-xpath/huaban_xpath_01.png" alt="xpath"></p><p>通过 <code>//div/div/div/div/a/img[1][@width=&quot;236&quot;]/@src</code> 即可顺利找到所有图片的 URL。</p><p><img src="http://harchiko.qiniudn.com/how-to-use-xpath/huaban_xpath_02.png" alt="xpath"></p><p>这样所有的 xpath 都获取到了。</p><p>这样就获取到了这些地址，但这些地址并不是原图大小的，对比原图与这个地址，发现后面 236 更改为 658 即可获取到大图地址。</p></div></article></div><div class="container"></div><div class="nav-links"><div class="nav-previous"><a href="/2015/01/27/change-google-font-to-360/" rel="prev"><span class="meta-arraw meta-arraw-left"></span> Older Posts</a></div><div class="nav-next"><a href="/2015/01/23/python-runs-directory/" rel="prev">Newer Posts <span class="meta-arraw meta-arraw-right"></span></a></div></div></div></div><div class="footer-widgets"><div class="row inside-wrapper"><div class="col-1-3"><aside><h1 class="widget-title">关于本站</h1><div class="custom-widget-content"><ul><li><a href="https://github.com/GallenHu/hexo-theme-Daily">如何自定义这里的内容(配置教程)?</a></li></ul></div></aside></div><div class="col-1-3"><aside><h1 class="widget-title">Contact</h1><div class="widget-text"><a href="https://github.com/zhaochunqi" class="icon icon-github" target="_blank">github</a> <a href="http://weibo.com/121189047" class="icon icon-weibo" target="_blank">weibo</a></div></aside></div><div class="col-1-3"><aside><h1 class="widget-title">Search</h1><div class="widget-text"><form onsubmit='return appDaily.submitSearch("")'><p><input type="text" placeholder="search..." id="homeSearchInput"></p></form></div></aside></div></div></div><footer class="site-info"><p><span>Alex Coding &copy; 2016</span> <span class="split">|</span><span>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> with Theme <a href="https://github.com/GallenHu/hexo-theme-Daily" target="_blank">Daily</a></span></p></footer><script src="//cdn.bootcss.com/zepto/1.2.0/zepto.min.js"></script><script src="/js/app.js"></script></body></html>