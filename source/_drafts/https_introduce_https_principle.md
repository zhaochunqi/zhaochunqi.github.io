title: 给女朋友看的 HTTPS 原理详解（一） ---- 初步认识
date: 2017-09-18 4:38 PM
categories: ""
tags: [https,]
---

![https](http://harchiko.qiniudn.com/HTTPS_icon.png)

> 今天，我们来趁着博客打算更新 https 来谈一波 https。

<!--more-->

## 什么是 https

当你访问网页的时候，你的地址栏出现如上图一样的小锁的标志的时候，就说明你用上 https 啦。

如果没有小锁， 比如 `http://www.baidu.com` 那就是 http 啦。

### http 为什么需要改变？

首先要说一下，当你访问网页，比如 `http://www.baidu.com` 的时候，你实际上呢是通过浏览器，去它的（这里是百度）服务器去请求或者发送数据，然后服务器给予回应，回应回来之后，浏览器通过一定的规则把页面解析成好看的样子展示给你。

传统的 http 登录请求数据是这样的

```
+------+  username   +------+
|client| +---------> |server|
+------+  password   +------+
```

现在有一个`坏人`想要偷取你的信息。他在你向服务器请求的中间做了一层代理。

```
+------+  username   +-------+  username   +------+
|client| +---------> |bad guy| +---------> |server|
+------+  password   +-------+  password   +------+
```

你的账号密码就这样暴露给了这个 `bad guy`，而且你也不会发觉到。

### https 介绍

很显然，http 给我们浏览网页带来了极大的方便，但同时这种方式也带来了不安全的因素。

如何既能用到 http 的便捷，又能保证信息数据传输的安全呢？

在 http 上加一层 tls, 这也是 https 名字的由来， http over tls -> https.

## https 如何实现？

前面我们讨论了 http 不安全，我们需要安全，但是我们不希望改变现有的 http 这种便捷.


### 1. 初步尝试 （对称加密）

client 端与 server 端约定一个共同的密码，比如说都是 12345 吧。

每次 client 端发送的时候都用 12345 这个密码来加密，然后在服务端解密。

来，我们看看能不能解决这个问题。



```
 +------+ encrypted username +-------+ encrypted username +------+
 |client| +----------------> |bad guy| +----------------> |server|
 +------+ encrypted password +-------+ encrypted password +------+

 ```

看起来，好像有一点问题：

1. 开始的时候 client 与 server 是互相知道密码的，如何保证 bad guy 不知道这个密码呢？
2. 当我要访问一个网站的时候，我到哪里知道这个密码呢？

一旦 bad guy 知道了这个密码，他就可以轻而易举的获取到数据了。

```
                           +---------+
                           |username |
                           |password |
                           +---------+
                                ^
                      key:12345 |decrypt
                                |
                                |
+------+ encrypted username +-------+ encrypted username +------+
|client| +----------------> |bad guy| +----------------> |server|
+------+ encrypted password +-------+ encrypted password +------+
```

可以看到如果解密的密码被知道了，加密就形同虚设了。

### 2. 进一步尝试 （非对称加密）

刚才我们尝试的时候，有一个问题就是我们如何知道这个密码？

有没有可能，服务器公布一个密码，然后通过这个密码加密之后的数据只有服务器才能解密呢？

有！-> 这种叫做非对称加密，不过这种非加密方法比对称加密方法慢数千倍。但是它更为安全！

通俗解释下非对称加密： A 和 B 是通过计算得到的两个秘钥， 通过 A 加密的数据只有通过 B 才能解密，同样，通过 B 加密的数据只有 A 才能解密。

用图来解释一下:

现在我们使用的方法是非对称加密，假设使用 A 来加密， B 能够从 A 加密的数据中解密。


```
                                      Decrypt with B

                                              +
                                              |
                                              |
                                              v
+------+ encrypted username +-------+ encrypted username +------+
|client| +----------------> |bad guy| +----------------> |server|
+------+ encrypted password +-------+ encrypted password +------+
                 ^
                 |
                 +
          Encrypted With A
```

2. 与上面不同的是， `bad guy` 知道数据是使用 A 来加密的，但是它没有办法解密。

看起来不错，但是呢还是有问题，速度太慢！

**对称加密速度快，但不够安全；非对称加密安全，但速度太慢**

### 3. 世间哪有两全法 （https 实现）

目前我们获取到的信息如下:

1. 对称加密速度快，如果不被中间人（bad guy) 获取到密码，这是很理想的传输方案。
2. 非对称加密速度慢，但是能够满足安全性的需要，他的安全足够使中间人无法解密数据。

有没有办法，用上对称加密的速度，又用上非对称加密的安全呢?

有，只要神不知鬼不觉的把对称加密的秘钥同时通知 client 跟 server 就行了。

具体怎么做，且听下回分解。  [给女朋友看的https详解 二](a)  <- 左边链接将在第二篇完成后更新。

